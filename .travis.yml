language: c

compiler:
  - clang
  - gcc

sudo: required

arch:
  repos:
    - wayland=https://dl.bintray.com/liri/archlinux-develop/$arch/
    - qtaccountsservice=https://dl.bintray.com/liri/archlinux-develop/$arch/
    - qtgsettings=https://dl.bintray.com/liri/archlinux-develop/$arch/
    - fluid=https://dl.bintray.com/liri/archlinux-develop/$arch/
    - libliri=https://dl.bintray.com/liri/archlinux-develop/$arch/
  packages:
    - qbs
    - qt5-tools
    - qt5-wayland
    - libqtxdg
    - liri-wayland-git
    - qtaccountsservice-git
    - qtgsettings-git
    - fluid-git
    - libliri-git
    - xorg-server-xvfb
    - clang
    #- clazy-git
  script:
    #- export CLAZY_CHECKS="level1"
    - qbs-setup-toolchains --detect
    - qbs-setup-qt /usr/bin/qmake-qt5 qt5
    - qbs config profiles.qt5.baseProfile ${CC}
    - eval `dbus-launch --sh-syntax` && xvfb-run -a -s "-screen 0 800x600x24" qbs -d qbs-build -j $(nproc) profile:qt5

script:
  - "curl -s https://raw.githubusercontent.com/mikkeloscar/arch-travis/master/arch-travis.sh | bash"

notifications:
  email: false
  slack: lirios:fdUqVmPzqPskEL1UBhqapZ0w
